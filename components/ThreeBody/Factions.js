import { useState } from 'react'
import CrossReferenceLink from './CrossReferenceLink'
import styles from './styles/Factions.module.css'

const factions = [
  {
    title: 'ÏÇºÏ≤¥-ÏßÄÍµ¨ Ï°∞ÏßÅ (ETO)',
    description: 'Ïù∏Î•òÎ•º Î∞∞Ïã†ÌïòÍ≥† ÏÇºÏ≤¥ Î¨∏Î™ÖÏùò ÏßÄÍµ¨ Ïπ®Í≥µÏùÑ ÎèïÎäî Ï°∞ÏßÅ. Íµ¨ÏÑ∏ÌååÏôÄ Íµ¨ÎèÑÌååÎ°ú Î∂ÑÏó¥',
    members: [
      { name: 'ÏòàÏõêÏ†ú', role: 'Ï≤úÏ≤¥Î¨ºÎ¶¨ÌïôÏûê, Ï°∞ÏßÅ Ï∞ΩÎ¶ΩÏûê' },
      { name: 'ÎßàÏù¥ÌÅ¨ ÏóêÎ∞òÏä§', role: 'ETO ÏàòÏû•, ÌôòÍ≤ΩÎ≥¥Ìò∏Ï£ºÏùòÏûê' }
    ],
    ideology: 'Ïù∏Î•òÏùò ÌÉÄÎùΩÍ≥º ÌôòÍ≤Ω ÌååÍ¥¥Î•º Ïù¥Ïú†Î°ú ÏÇºÏ≤¥ Î¨∏Î™ÖÏù¥ Îçî ÎÇòÏùÄ ÏÇ¨ÌöåÎ•º Í±¥ÏÑ§Ìï† Í≤ÉÏù¥Îùº ÎØøÏùå',
    alignment: 'ÏÇºÏ≤¥',
    size: 2
  },
  {
    title: 'Íµ¨ÏÑ∏Ìåå (Adventist)',
    description: 'ETO ÎÇ¥ Í∑πÎã®Ï£ºÏùò Î∂ÑÌåå. ÏÇºÏ≤¥Ïùò ÏôÑÏ†ÑÌïú ÏäπÎ¶¨ÏôÄ Ïù∏Î•ò Ï†ïÎ≥µ ÏßÄÏßÄ',
    members: [
      { name: 'ÎßàÏù¥ÌÅ¨ ÏóêÎ∞òÏä§', role: 'Íµ¨ÏÑ∏Ìåå ÏßÄÎèÑÏûê' },
      { name: 'ÌåêÌïú', role: 'ÏÉùÎ¨ºÌïôÏûê, Ïù∏Î•ò Î©∏Ï¢Ö ÏßÄÏßÄ' }
    ],
    ideology: 'Ïù∏Î•òÎäî Íµ¨ÏõêÎ∞õÏùÑ Í∞ÄÏπòÍ∞Ä ÏóÜÏúºÎ©∞ ÏÇºÏ≤¥Í∞Ä ÏßÄÍµ¨Î•º ÏôÑÏ†ÑÌûà Ï†ïÎ≥µÌï¥Ïïº ÌïúÎã§Í≥† ÎØøÏùå. Í∞ÄÏû• Í∑πÎã®Ï†ÅÏù∏ ÏÇºÏ≤¥ Ïà≠Î∞∞ÏûêÎì§',
    alignment: 'ÏÇºÏ≤¥',
    size: 2
  },
  {
    title: 'Íµ¨ÎèÑÌåå (Redemptionist)',
    description: 'ETO ÎÇ¥ Ïò®Í±¥ Î∂ÑÌåå. ÏÇºÏ≤¥ÏôÄ Ïù∏Î•òÏùò Í≥µÏ°¥ Ï∂îÍµ¨',
    members: [
      { name: 'ÏÖ¥ÏúÑ', role: 'Íµ¨ÎèÑÌåå ÏßÄÎèÑÎ∂Ä' }
    ],
    ideology: 'ÏÇºÏ≤¥ Î¨∏Î™ÖÏùò ÎèÑÏõÄÏúºÎ°ú Ïù∏Î•ò ÏÇ¨ÌöåÎ•º Í∞úÌòÅÌïòÍ≥† Í≥µÏ°¥ÏùÑ Î™®ÏÉâ. Íµ¨ÏÑ∏ÌååÎ≥¥Îã§ Ïò®Í±¥ÌïòÏßÄÎßå Ïó¨Ï†ÑÌûà Ïù∏Î•ò Î∞∞Ïã†Ïûê',
    alignment: 'ÏÇºÏ≤¥',
    size: 1
  },
  {
    title: 'Î©¥Î≤ΩÏûê ÌîÑÎ°úÏ†ùÌä∏',
    description: 'ÏÇºÏ≤¥Ïùò ÏßÄÏûê Í∞êÏãúÎ•º ÌîºÌï¥ ÎèÖÎ¶ΩÏ†ÅÏúºÎ°ú Î∞©Ïñ¥ Í≥ÑÌöçÏùÑ ÏàòÌñâÌïòÎäî 4Î™ÖÏùò Ï†ÑÎûµÍ∞Ä',
    members: [
      { name: 'Î§ÑÏßÄ', role: 'ÏÇ¨ÌöåÌïôÏûê, ÏÑ±Í≥µÌïú Î©¥Î≤ΩÏûê (ÏïîÌùëÏùò Ïà≤ Ïù¥Î°†)' },
      { name: 'ÌîÑÎ†àÎìúÎ¶≠ ÌÉÄÏùºÎü¨', role: 'Ï†Ñ ÎØ∏Íµ≠ Íµ≠Î∞©Ïû•Í¥Ä (Ïã§Ìå®)' },
      { name: 'ÎßàÎàÑÏóò Î†àÏù¥ÎîîÏïÑÏ¶à', role: 'Î≤†ÎÑ§ÏàòÏóòÎùº ÎåÄÌÜµÎ†π (Ïã§Ìå®)' },
      { name: 'Îπå ÌïòÏù∏Ï¶à', role: 'Ïã†Í≤ΩÍ≥ºÌïôÏûê (Ïã§Ìå®)' }
    ],
    ideology: 'ÏßÄÏûêÏùò Í∞êÏãúÎ•º ÌîºÌï¥ ÏÉùÍ∞ÅÎßåÏúºÎ°ú Ï†ÑÎûµÏùÑ ÏàòÎ¶ΩÌïòÍ≥† Ïã§Ìñâ. Ïò§ÏßÅ Î§ÑÏßÄÎßåÏù¥ ÏÑ±Í≥µ',
    alignment: 'Ïù∏Î•ò',
    size: 4
  },
  {
    title: 'Í≤ÄÏû°Ïù¥',
    description: 'ÏïîÌùëÏùò Ïà≤ ÌÉÄÍ≤© Ïä§ÏúÑÏπòÎ•º Í∞ÄÏßÑ Ïûê, ÏÇºÏ≤¥Î•º ÏúÑÌòëÌïòÏó¨ ÌèâÌôî Ïú†ÏßÄ',
    members: [
      { name: 'Î§ÑÏßÄ', role: 'Ï¥àÎåÄ Í≤ÄÏû°Ïù¥, 62ÎÖÑÍ∞Ñ ÌèâÌôî Ïú†ÏßÄ' },
      { name: 'Ï†ïÏ≤≠Ïã†', role: '2ÎåÄ Í≤ÄÏû°Ïù¥, ÏúÑÌòë Ïã§Ìå®Î°ú Ïù∏Î•ò Î©∏Îßù ÏúÑÍ∏∞ Ï¥àÎûò' }
    ],
    ideology: 'ÏÉÅÌò∏ÌôïÏ¶ùÌååÍ¥¥(MAD) Í∞úÎÖêÏúºÎ°ú ÏÇºÏ≤¥ÏôÄ ÏßÄÍµ¨Ïùò Í∑†Ìòï Ïú†ÏßÄ. Í≤ÄÏû°Ïù¥Ïùò ÏùòÏßÄÏôÄ Í≤∞Îã®Ïù¥ ÌïµÏã¨',
    alignment: 'Ïù∏Î•ò',
    size: 2
  },
  {
    title: 'Í≥ºÌïôÏûê Í∑∏Î£π',
    description: 'ÏÇºÏ≤¥ ÏúÑÍ∏∞Ïóê ÎßûÏÑú Í≥ºÌïôÏ†Å Ìï¥Î≤ïÏùÑ Ï∞æÎäî Í≥ºÌïôÏûêÎì§',
    members: [
      { name: 'ÏôïÎ®ÄÏò§', role: 'ÎÇòÎÖ∏Ïû¨Î£å Ïó∞Íµ¨Ïûê, ÎÇòÎÖ∏ÏôÄÏù¥Ïñ¥ Í∞úÎ∞ú' },
      { name: 'ÏñëÎë•', role: 'Ïù¥Î°†Î¨ºÎ¶¨ÌïôÏûê, ÏòàÏõêÏ†úÏùò Îî∏' },
      { name: 'Îî©Ïù¥', role: 'Ïù¥Î°†Î¨ºÎ¶¨ÌïôÏûê, Î¨ºÎ¶¨Ìïô Î≤ïÏπô Î∂ïÍ¥¥ Î∞úÍ≤¨' },
      { name: 'Í¥ÄÏù¥Ìåê', role: 'Ïù¥Î°†Î¨ºÎ¶¨ÌïôÏûê, Ïö∞Ï£º Î≤ïÏπô Ïó∞Íµ¨' }
    ],
    ideology: 'Í≥ºÌïôÏùÑ ÌÜµÌïú Ïù∏Î•ò ÏÉùÏ°¥. Í∑∏Îü¨ÎÇò ÏßÄÏûêÏóê ÏùòÌï¥ Í≥ºÌïô Î∞úÏ†ÑÏù¥ Î¥âÏáÑÎê®',
    alignment: 'Ïù∏Î•ò',
    size: 4
  },
  {
    title: 'Ï†ïÎ∂Ä Î∞è Íµ≠Ï†úÍ∏∞Íµ¨',
    description: 'ÏÇºÏ≤¥ ÏúÑÍ∏∞Ïóê ÎåÄÏùëÌïòÎäî Í∞ÅÍµ≠ Ï†ïÎ∂ÄÏôÄ Íµ≠Ï†úÍ∏∞Íµ¨',
    members: [
      { name: 'ÏÑ∏Ïù¥', role: 'UN ÏÇ¨Î¨¥Ï¥ùÏû•, Ï†ïÏπò ÏßÄÎèÑÏûê' },
      { name: 'ÏºÑÌä∏', role: 'Ïô∏ÍµêÍ¥Ä, Î©¥Î≤Ω Í≥ÑÌöç Ï°∞Ïú®Ïûê' },
      { name: 'Í∞ÄÎùºÎãõ', role: 'PDC ÏùòÏû•, ÌñâÏÑ±Î∞©ÏúÑÏù¥ÏÇ¨Ìöå ÏàòÏû•' },
      { name: 'ÌÜ†ÎßàÏä§ Ïõ®Ïù¥Îìú', role: 'PIA Íµ≠Ïû•, Í¥ëÏÜç Ï∂îÏßÑ ÏßÄÏßÄÏûê' }
    ],
    ideology: 'Ïù∏Î•ò ÏÉùÏ°¥ÏùÑ ÏúÑÌïú ÌòÑÏã§Ï£ºÏùòÏ†Å Ï†ëÍ∑º. ÎïåÎ°úÎäî ÎÉâÌòπÌïú Í≤∞Ï†ïÎèÑ Î∂àÏÇ¨',
    alignment: 'Ïù∏Î•ò',
    size: 4
  },
  {
    title: 'Ïö∞Ï£ºÍµ∞',
    description: 'ÏÇºÏ≤¥ Ìï®ÎåÄÏôÄÏùò Ï†ÑÌà¨Î•º Ï§ÄÎπÑÌïòÎäî Ïö∞Ï£º Ï†ÑÎ†•',
    members: [
      { name: 'Ïû•Î≤†Ïù¥ÌïòÏù¥', role: 'Ïö∞Ï£ºÍµ∞ Ï†ïÏπòÏúÑÏõê, Í∑πÎã®Ï†Å ÏÉùÏ°¥Ï£ºÏùòÏûê' },
      { name: 'Ï∞ΩÏõ®Ïù¥Ïä§', role: 'Ïö∞Ï£ºÍµ∞ Ïû•Íµ∞, ÌòÑÏã§Ï†Å Î∞©Ïñ¥Ï£ºÏùòÏûê' },
      { name: 'Îë•ÌéëÏõ®Ïù¥', role: 'Ïó¨ÏÑ± Ìï®ÎåÄ ÏÇ¨Î†πÍ¥Ä' },
      { name: 'Ïö∞Ïõ®Ïù¥', role: 'Î∏îÎ£®Ïä§ÌéòÏù¥Ïä§Ìò∏ Ìï®Ïû•' },
      { name: 'Î≤§Ï†Ä ÏãúÌä∏', role: 'ÏûêÏó∞ÏÑ†ÌÉùÌò∏ Ìï®Ïû•' }
    ],
    ideology: 'Ïù∏Î•òÏùò Ïö∞Ï£º ÌÉàÏ∂úÍ≥º ÏÉùÏ°¥. Ïû•Î≤†Ïù¥ÌïòÏù¥Ïùò ÎèÑÎßùÏ£ºÏùò vs Ï∞ΩÏõ®Ïù¥Ïä§Ïùò Î∞©Ïñ¥Ï£ºÏùò',
    alignment: 'Ïù∏Î•ò',
    size: 5
  },
  {
    title: 'ÏÇºÏ≤¥ Î¨∏Î™Ö',
    description: 'ÌòºÎèàÏùò 3Ìï≠ÏÑ±Í≥ÑÏóêÏÑú Ïò® Ïô∏Í≥Ñ Î¨∏Î™Ö',
    members: [
      { name: 'ÏÇºÏ≤¥ ÌèâÌôîÏ£ºÏùòÏûê', role: 'ÏßÄÍµ¨Ïóê Í≤ΩÍ≥† Ïã†Ìò∏Î•º Î≥¥ÎÇ∏ ÏÇºÏ≤¥Ïù∏' },
      { name: 'ÏúàÌÜàÎ∞ç', role: 'ÏÇºÏ≤¥Ïóê Ìè¨Î°úÎ°ú Ïû°Ìûå Ïù∏Í∞Ñ, ÎèôÌôîÎ°ú Í≤ΩÍ≥† Ï†ÑÎã¨' },
      { name: 'ÏßÄÏûê(Êô∫Â≠ê)', role: 'ÏñëÏûê ÏûÖÏûê Í∏∞Î∞ò AI, ÏßÄÍµ¨ Í∞êÏãú' }
    ],
    ideology: 'ÏÉùÏ°¥ÏùÑ ÏúÑÌïú ÌïÑÏÇ¨Ï†Å ÎÖ∏Î†•. 3Ìï≠ÏÑ±Í≥ÑÏùò Î∂àÏïàÏ†ïÏÑ±ÏúºÎ°ú ÏÉàÎ°úÏö¥ ÌñâÏÑ± ÌïÑÏöî',
    alignment: 'ÏÇºÏ≤¥',
    size: 3
  },
  {
    title: 'ÏµúÏ¢Ö ÏÉùÏ°¥Ïûê',
    description: 'Ïö∞Ï£ºÏùò Ï¢ÖÎßêÏùÑ ÎÑòÏñ¥ ÏÉàÎ°úÏö¥ ÏãúÏûëÏóê Í∏∞Ïó¨ÌïòÎäî ÏûêÎì§',
    members: [
      { name: 'Ï†ïÏ≤≠Ïã†', role: 'ÏÜåÏö∞Ï£ºÏóê ÎÇ®ÏïÑ Ïö∞Ï£º Ïû¨ÏãúÏûë Ï∞∏Ïó¨' },
      { name: 'Í¥ÄÏù¥Ìåê', role: 'Ï†ïÏ≤≠Ïã†Í≥º Ìï®Íªò ÏÉàÎ°úÏö¥ Ïö∞Ï£º ÌÉÑÏÉùÏóê Í∏∞Ïó¨' }
    ],
    ideology: 'ÏÇ¨ÎûëÍ≥º Ìù¨ÏÉùÏùÑ ÌÜµÌïú Íµ¨Ïõê. Ïö∞Ï£ºÏùò Ïû¨ÏãúÏûëÍ≥º ÏÉàÎ°úÏö¥ ÏãúÏûë',
    alignment: 'Ï§ëÎ¶Ω',
    size: 2
  }
]

export default function Factions() {
  const [alignmentFilter, setAlignmentFilter] = useState('all')
  const [sortBy, setSortBy] = useState('size')
  const [selectedFaction, setSelectedFaction] = useState(null)

  // Filter factions by alignment
  const filteredFactions = factions.filter(faction => {
    if (alignmentFilter === 'all') return true
    return faction.alignment === alignmentFilter
  })

  // Sort factions
  const sortedFactions = [...filteredFactions].sort((a, b) => {
    if (sortBy === 'size') return b.size - a.size
    if (sortBy === 'name') return a.title.localeCompare(b.title, 'ko')
    return 0
  })

  // Calculate statistics
  const stats = {
    total: factions.length,
    humanity: factions.filter(f => f.alignment === 'Ïù∏Î•ò').length,
    trisolaris: factions.filter(f => f.alignment === 'ÏÇºÏ≤¥').length,
    neutral: factions.filter(f => f.alignment === 'Ï§ëÎ¶Ω').length,
    totalMembers: factions.reduce((sum, f) => sum + f.size, 0)
  }

  return (
    <div className={styles.factionsContainer}>
      {/* Statistics Dashboard */}
      <div className={styles.statsPanel}>
        <h3 className={styles.statsTitle}>ÏÑ∏Î†• ÌÜµÍ≥Ñ</h3>
        <div className={styles.statsGrid}>
          <div className={styles.statCard}>
            <div className={styles.statNumber}>{stats.total}</div>
            <div className={styles.statLabel}>Ï¥ù ÏÑ∏Î†•</div>
          </div>
          <div className={styles.statCard}>
            <div className={styles.statNumber} style={{color: '#4ecdc4'}}>{stats.humanity}</div>
            <div className={styles.statLabel}>Ïù∏Î•ò ÏÑ∏Î†•</div>
          </div>
          <div className={styles.statCard}>
            <div className={styles.statNumber} style={{color: '#ff6b6b'}}>{stats.trisolaris}</div>
            <div className={styles.statLabel}>ÏÇºÏ≤¥ ÏÑ∏Î†•</div>
          </div>
          <div className={styles.statCard}>
            <div className={styles.statNumber} style={{color: '#ffce56'}}>{stats.neutral}</div>
            <div className={styles.statLabel}>Ï§ëÎ¶Ω</div>
          </div>
          <div className={styles.statCard}>
            <div className={styles.statNumber}>{stats.totalMembers}</div>
            <div className={styles.statLabel}>Ï¥ù Ïù∏Ïõê</div>
          </div>
        </div>
      </div>

      {/* Control Panel */}
      <div className={styles.controlPanel}>
        <div className={styles.filterGroup}>
          <button
            onClick={() => setAlignmentFilter('all')}
            className={`${styles.filterButton} ${alignmentFilter === 'all' ? styles.active : ''}`}
          >
            Ï†ÑÏ≤¥
          </button>
          <button
            onClick={() => setAlignmentFilter('Ïù∏Î•ò')}
            className={`${styles.filterButton} ${alignmentFilter === 'Ïù∏Î•ò' ? styles.active : ''}`}
          >
            Ïù∏Î•ò ÏÑ∏Î†•
          </button>
          <button
            onClick={() => setAlignmentFilter('ÏÇºÏ≤¥')}
            className={`${styles.filterButton} ${alignmentFilter === 'ÏÇºÏ≤¥' ? styles.active : ''}`}
          >
            ÏÇºÏ≤¥ ÏÑ∏Î†•
          </button>
          <button
            onClick={() => setAlignmentFilter('Ï§ëÎ¶Ω')}
            className={`${styles.filterButton} ${alignmentFilter === 'Ï§ëÎ¶Ω' ? styles.active : ''}`}
          >
            Ï§ëÎ¶Ω
          </button>
        </div>

        <select
          value={sortBy}
          onChange={(e) => setSortBy(e.target.value)}
          className={styles.select}
        >
          <option value="size">Ïù∏Ïõê ÎßéÏùÄ Ïàú</option>
          <option value="name">Ïù¥Î¶ÑÏàú</option>
        </select>
      </div>

      {/* Result Count */}
      <div className={styles.resultCount}>
        {sortedFactions.length}Í∞úÏùò ÏÑ∏Î†•
      </div>

      {/* Faction Grid */}
      <div className={styles.factionGrid}>
        {sortedFactions.map((faction, index) => (
          <div
            key={index}
            className={`${styles.factionCard} ${styles[faction.alignment]}`}
            style={{ animationDelay: `${index * 0.1}s` }}
            onClick={() => setSelectedFaction(selectedFaction === index ? null : index)}
          >
            <div className={styles.factionHeader}>
              <div className={styles.factionTitle}>{faction.title}</div>
              <div className={styles.alignmentBadge}>
                {faction.alignment === 'Ïù∏Î•ò' && 'üåç'}
                {faction.alignment === 'ÏÇºÏ≤¥' && 'üëΩ'}
                {faction.alignment === 'Ï§ëÎ¶Ω' && '‚öñÔ∏è'}
                <span>{faction.alignment}</span>
              </div>
            </div>

            <div className={styles.memberCount}>
              Íµ¨ÏÑ±Ïõê: {faction.size}Î™Ö
            </div>

            <div className={styles.factionDescription}>{faction.description}</div>

            <div className={styles.factionIdeology}>
              <strong>Ïù¥ÎÖê:</strong> {faction.ideology}
            </div>

            {selectedFaction === index && (
              <div className={styles.memberExpanded}>
                <h4 className={styles.memberTitle}>Íµ¨ÏÑ±Ïõê ÏÉÅÏÑ∏</h4>
                <ul className={styles.factionMembers}>
                  {faction.members.map((member, i) => (
                    <li key={i}>
                      <div className={styles.memberName}>
                        <CrossReferenceLink type="character" name={member.name} />
                      </div>
                      <div className={styles.memberRole}>{member.role}</div>
                    </li>
                  ))}
                </ul>
              </div>
            )}

            <div className={styles.expandHint}>
              {selectedFaction === index ? 'ÌÅ¥Î¶≠ÌïòÏó¨ Ï†ëÍ∏∞ ‚ñ≤' : 'ÌÅ¥Î¶≠ÌïòÏó¨ Íµ¨ÏÑ±Ïõê Î≥¥Í∏∞ ‚ñº'}
            </div>
          </div>
        ))}
      </div>
    </div>
  )
}
